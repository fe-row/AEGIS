# ══════════════════════════════════════════════════
#  AEGIS Helm Chart — Default Values
# ══════════════════════════════════════════════════

# ── Global ──
global:
  domain: aegis.example.com

# ── Backend ──
backend:
  replicaCount: 2
  image:
    repository: ghcr.io/your-org/aegis-backend
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      memory: 256Mi
      cpu: 250m
    limits:
      memory: 1Gi
      cpu: "2"
  env:
    ENVIRONMENT: production
    DB_POOL_SIZE: "20"
    DB_MAX_OVERFLOW: "10"
    OTEL_ENABLED: "false"
    SSO_ENABLED: "false"
    SECRETS_PROVIDER: "env"
  # Reference existing K8s secrets for sensitive values
  secretRef: aegis-secrets

# ── Frontend ──
frontend:
  replicaCount: 2
  image:
    repository: ghcr.io/your-org/aegis-frontend
    tag: latest
    pullPolicy: IfNotPresent
  resources:
    requests:
      memory: 128Mi
      cpu: 100m
    limits:
      memory: 512Mi
      cpu: "1"

# ── PostgreSQL ──
postgres:
  # Set enabled=false to use external managed DB (RDS, Cloud SQL)
  enabled: true
  image: postgres:16-alpine
  storage: 20Gi
  storageClass: ""
  resources:
    requests:
      memory: 256Mi
      cpu: 250m
    limits:
      memory: 512Mi
      cpu: "1"

# ── Redis ──
redis:
  # Set enabled=false to use external Redis (ElastiCache, etc)
  enabled: true
  image: redis:7-alpine
  storage: 5Gi
  storageClass: ""
  resources:
    requests:
      memory: 128Mi
      cpu: 100m
    limits:
      memory: 300Mi
      cpu: "0.5"

# ── OPA ──
opa:
  image: openpolicyagent/opa:latest-static
  resources:
    requests:
      memory: 64Mi
      cpu: 50m
    limits:
      memory: 128Mi
      cpu: "0.25"

# ── Ingress ──
ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/proxy-body-size: 10m
  tls:
    enabled: true
    secretName: aegis-tls

# ── Autoscaling ──
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 70
  targetMemoryUtilizationPercentage: 80

# ── Pod Disruption Budget ──
pdb:
  enabled: true
  minAvailable: 1
